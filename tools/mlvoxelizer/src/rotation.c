////////////////////////////////////////////////////////////


#include <stdio.h>
#include <math.h>
#include <stdlib.h>
#define ROTATION_C
#include "rotation.h"


////////////////////////////////////////////////////////////


#define HOMOGENEOUS  "http://www.it.hiof.no/~borres/j3d/math/homo/p-homo.html"

#ifdef HOMOGENEOUS
#define _ROWS 4
#define _COLS 4
#define _Z    , 0.0
#define _E    , { 0.0, 0.0, 0.0, 1.0 }
#else
#define _Z
#define _E
#define _ROWS 3
#define _COLS 3
#endif

////////////////////////////////////////////////////////////


typedef double matrix[ _ROWS][_COLS];


////////////////////////////////////////////////////////////


static matrix Rotations[59] = {

 {{ 0.809016994374947424, -0.5, 0.3090169943749474242 _Z },
  { 0.5, 0.309016994374947424, -0.809016994374947424 _Z },
  { 0.3090169943749474242, 0.809016994374947424, 0.5 _Z } _E },

 {{ 0.809016994374947424, 0.5, -0.3090169943749474241 _Z },
  { -0.5, 0.309016994374947424, -0.809016994374947424 _Z },
  { -0.3090169943749474241, 0.809016994374947424, 0.5 _Z } _E },

 {{ 0.5, -0.3090169943749474241, 0.8090169943749474241 _Z },
  { 0.3090169943749474241, -0.809016994374947424, -0.5 _Z },
  { 0.8090169943749474241, 0.5, -0.3090169943749474241 _Z } _E },

 {{ 0.8090169943749474241, 0.5, 0.3090169943749474241 _Z },
  { 0.5, -0.309016994374947424, -0.809016994374947424 _Z },
  { -0.3090169943749474241, 0.809016994374947424, -0.5 _Z } _E },

 {{ 0.8090169943749474241, -0.5, -0.3090169943749474241 _Z },
  { -0.5, -0.309016994374947424, -0.809016994374947424 _Z },
  { 0.3090169943749474241, 0.809016994374947424, -0.5 _Z } _E },

 {{ 0.5, 0.3090169943749474241, -0.8090169943749474241 _Z },
  { -0.3090169943749474241, -0.809016994374947424, -0.5 _Z },
  { -0.8090169943749474241, 0.5, -0.3090169943749474241 _Z } _E },

 {{ 0.3090169943749474242, -0.8090169943749474241, 0.5 _Z },
  { -0.8090169943749474241, -0.5, -0.3090169943749474241 _Z },
  { 0.5, -0.3090169943749474241, -0.8090169943749474242 _Z } _E },

 {{ 1.0, 0.0, 0.0 _Z },
  { 0.0, -1.0, 0.0 _Z },
  { 0.0, 0.0, -1.0 _Z } _E },

 {{ 0.5, 0.3090169943749474241, 0.8090169943749474242 _Z },
  { -0.3090169943749474241, -0.809016994374947424, 0.5 _Z },
  { 0.8090169943749474241, -0.5, -0.3090169943749474242 _Z } _E },

 {{ 0.3090169943749474242, 0.8090169943749474241, 0.5 _Z },
  { 0.8090169943749474241, -0.5, 0.3090169943749474241 _Z },
  { 0.5, 0.3090169943749474241, -0.8090169943749474242 _Z } _E },

 {{ 0.3090169943749474242, 0.8090169943749474241, -0.5 _Z },
  { 0.8090169943749474241, -0.5, -0.3090169943749474241 _Z },
  { -0.5, -0.3090169943749474241, -0.8090169943749474242 _Z } _E },

 {{ 0.8090169943749474243, -0.5, 0.3090169943749474242 _Z },
  { -0.5, -0.3090169943749474241, 0.8090169943749474242 _Z },
  { -0.3090169943749474242, -0.8090169943749474242, -0.5 _Z } _E },

 {{ 0.809016994374947424, 0.5, -0.3090169943749474242 _Z },
  { 0.5, -0.309016994374947424, 0.809016994374947424 _Z },
  { 0.3090169943749474242, -0.809016994374947424, -0.5 _Z } _E },

 {{ 0.3090169943749474242, -0.8090169943749474241, -0.5 _Z },
  { -0.8090169943749474241, -0.5, 0.3090169943749474241 _Z },
  { -0.5, 0.3090169943749474241, -0.8090169943749474241 _Z } _E },

 {{ 0.5, -0.3090169943749474241, -0.8090169943749474242 _Z },
  { 0.3090169943749474241, -0.809016994374947424, 0.5 _Z },
  { -0.8090169943749474241, -0.5, -0.3090169943749474242 _Z } _E },

 {{ -0.3090169943749474242, -0.8090169943749474242, 0.5 _Z },
  { -0.8090169943749474242, 0.5, 0.3090169943749474242 _Z },
  { -0.5, -0.3090169943749474242, -0.8090169943749474242 _Z } _E },

 {{ 0.0, 0.0, 1.0 _Z },
  { -1.0, 0.0, 0.0 _Z },
  { 0.0, -1.0, 0.0 _Z } _E },

 {{ 0.5, -0.3090169943749474242, 0.809016994374947424 _Z },
  { -0.3090169943749474242, 0.8090169943749474242, 0.5 _Z },
  { -0.809016994374947424, -0.5, 0.3090169943749474242 _Z } _E },

 {{ 0.8090169943749474241, 0.5, 0.3090169943749474241 _Z },
  { -0.5, 0.309016994374947424, 0.809016994374947424 _Z },
  { 0.3090169943749474241, -0.809016994374947424, 0.5 _Z } _E },

 {{ 0.0, 1.0, 0.0 _Z },
  { 0.0, 0.0, 1.0 _Z },
  { 1.0, 0.0, 0.0 _Z } _E },

 {{ -0.3090169943749474242, 0.8090169943749474242, -0.5 _Z },
  { 0.8090169943749474242, 0.5, 0.3090169943749474242 _Z },
  { 0.5, -0.3090169943749474242, -0.8090169943749474242 _Z } _E },

 {{ 0.809016994374947424, -0.5, -0.3090169943749474242 _Z },
  { 0.5, 0.3090169943749474242, 0.8090169943749474243 _Z },
  { -0.3090169943749474242, -0.8090169943749474242, 0.5 _Z } _E },

 {{ 0.5, 0.3090169943749474241, -0.8090169943749474241 _Z },
  { 0.3090169943749474241, 0.809016994374947424, 0.5 _Z },
  { 0.8090169943749474241, -0.5, 0.3090169943749474241 _Z } _E },

 {{ 0.0, 0.0, -1.0 _Z },
  { 1.0, 0.0, 0.0 _Z },
  { 0.0, -1.0, 0.0 _Z } _E },

 {{ 0.0, -1.0, 0.0 _Z },
  { 0.0, 0.0, 1.0 _Z },
  { -1.0, 0.0, 0.0 _Z } _E },

 {{ 0.3090169943749474242, -0.809016994374947424, 0.5 _Z },
  { 0.809016994374947424, 0.5, 0.3090169943749474242 _Z },
  { -0.5, 0.3090169943749474242, 0.8090169943749474246 _Z } _E },

 {{ -0.5, -0.3090169943749474242, 0.8090169943749474243 _Z },
  { 0.3090169943749474242, 0.8090169943749474241, 0.5 _Z },
  { -0.809016994374947424, 0.5, -0.3090169943749474242 _Z } _E },

 {{ -0.5, 0.3090169943749474241, 0.809016994374947424 _Z },
  { -0.309016994374947424, 0.809016994374947424, -0.5 _Z },
  { -0.809016994374947424, -0.5, -0.3090169943749474241 _Z } _E },

 {{ 0.5, 0.3090169943749474242, 0.8090169943749474246 _Z },
  { 0.3090169943749474242, 0.8090169943749474243, -0.5 _Z },
  { -0.809016994374947424, 0.5, 0.3090169943749474242 _Z } _E },

 {{ 0.3090169943749474242, 0.8090169943749474241, 0.5 _Z },
  { -0.8090169943749474241, 0.5, -0.3090169943749474241 _Z },
  { -0.5, -0.3090169943749474241, 0.8090169943749474241 _Z } _E },

 {{ -0.3090169943749474241, 0.809016994374947424, 0.5 _Z },
  { -0.809016994374947424, -0.5, 0.309016994374947424 _Z },
  { 0.5, -0.3090169943749474241, 0.809016994374947424 _Z } _E },

 {{ 0.3090169943749474242, 0.8090169943749474241, -0.5 _Z },
  { -0.8090169943749474241, 0.5, 0.3090169943749474241 _Z },
  { 0.5, 0.3090169943749474241, 0.8090169943749474242 _Z } _E },

 {{ -0.5, 0.3090169943749474241, -0.8090169943749474243 _Z },
  { -0.3090169943749474242, 0.8090169943749474241, 0.5 _Z },
  { 0.809016994374947424, 0.5, -0.3090169943749474242 _Z } _E },

 {{ 0.3090169943749474242, -0.8090169943749474243, -0.5 _Z },
  { 0.809016994374947424, 0.5, -0.3090169943749474242 _Z },
  { 0.5, -0.3090169943749474242, 0.8090169943749474246 _Z } _E },

 {{ 0.5, -0.3090169943749474241, -0.8090169943749474242 _Z },
  { -0.3090169943749474241, 0.809016994374947424, -0.5 _Z },
  { 0.8090169943749474241, 0.5, 0.3090169943749474242 _Z } _E },

 {{ -0.5, -0.3090169943749474242, -0.809016994374947424 _Z },
  { 0.309016994374947424, 0.809016994374947424, -0.5 _Z },
  { 0.809016994374947424, -0.5, -0.3090169943749474242 _Z } _E },

 {{ -0.3090169943749474242, -0.809016994374947424, -0.5 _Z },
  { 0.809016994374947424, -0.5, 0.309016994374947424 _Z },
  { -0.5, -0.3090169943749474242, 0.809016994374947424 _Z } _E },

 {{ -0.3090169943749474242, -0.8090169943749474246, 0.5 _Z },
  { 0.8090169943749474246, -0.5, -0.3090169943749474242 _Z },
  { 0.5, 0.3090169943749474242, 0.8090169943749474246 _Z } _E },

 {{ -0.8090169943749474246, -0.5, 0.3090169943749474242 _Z },
  { 0.5, -0.3090169943749474242, 0.8090169943749474243 _Z },
  { -0.3090169943749474242, 0.809016994374947424, 0.5 _Z } _E },

 {{ 0.0, 0.0, 1.0 _Z },
  { 1.0, 0.0, 0.0 _Z },
  { 0.0, 1.0, 0.0 _Z } _E },

 {{ -0.3090169943749474241, 0.8090169943749474241, 0.5 _Z },
  { 0.809016994374947424, 0.5, -0.3090169943749474241 _Z },
  { -0.5, 0.3090169943749474241, -0.8090169943749474241 _Z } _E },

 {{ 0.0, 1.0, 0.0 _Z },
  { 0.0, 0.0, -1.0 _Z },
  { -1.0, 0.0, 0.0 _Z } _E },

 {{ -0.8090169943749474241, 0.5, 0.3090169943749474241 _Z },
  { -0.5, -0.3090169943749474241, -0.809016994374947424 _Z },
  { -0.3090169943749474241, -0.8090169943749474241, 0.5 _Z } _E },

 {{ -0.3090169943749474242, 0.8090169943749474242, -0.5 _Z },
  { -0.8090169943749474242, -0.5, -0.3090169943749474242 _Z },
  { -0.5, 0.3090169943749474242, 0.8090169943749474242 _Z } _E },

 {{ -0.8090169943749474246, 0.5, -0.3090169943749474242 _Z },
  { -0.5, -0.3090169943749474241, 0.8090169943749474243 _Z },
  { 0.3090169943749474242, 0.8090169943749474242, 0.5 _Z } _E },

 {{ 0.0, 0.0, -1.0 _Z },
  { -1.0, 0.0, 0.0 _Z },
  { 0.0, 1.0, 0.0 _Z } _E },

 {{ 0.0, -1.0, 0.0 _Z },
  { 0.0, 0.0, -1.0 _Z },
  { 1.0, 0.0, 0.0 _Z } _E },

 {{ -0.3090169943749474241, -0.8090169943749474241, -0.5 _Z },
  { -0.809016994374947424, 0.5, -0.3090169943749474241 _Z },
  { 0.5, 0.3090169943749474241, -0.8090169943749474241 _Z } _E },

 {{ -0.8090169943749474241, -0.5, -0.3090169943749474241 _Z },
  { 0.5, -0.3090169943749474241, -0.809016994374947424 _Z },
  { 0.3090169943749474241, -0.8090169943749474241, 0.5 _Z } _E },

 {{ -0.5, -0.3090169943749474242, 0.8090169943749474244 _Z },
  { -0.3090169943749474242, -0.8090169943749474246, -0.5 _Z },
  { 0.809016994374947424, -0.5, 0.3090169943749474242 _Z } _E },

 {{ -1.0, 0.0, 0.0 _Z },
  { 0.0, -1.0, 0.0 _Z },
  { 0.0, 0.0, 1.0 _Z } _E },

 {{ -0.5, 0.3090169943749474242, 0.809016994374947424 _Z },
  { 0.309016994374947424, -0.809016994374947424, 0.5 _Z },
  { 0.809016994374947424, 0.5, 0.3090169943749474242 _Z } _E },

 {{ -0.8090169943749474241, 0.5, 0.3090169943749474242 _Z },
  { 0.5, 0.3090169943749474241, 0.8090169943749474241 _Z },
  { 0.3090169943749474241, 0.8090169943749474242, -0.5 _Z } _E },

 {{ -0.8090169943749474242, 0.5, -0.3090169943749474241 _Z },
  { 0.5, 0.3090169943749474241, -0.809016994374947424 _Z },
  { -0.3090169943749474242, -0.8090169943749474241, -0.5 _Z } _E },

 {{ -0.5, 0.3090169943749474242, -0.8090169943749474243 _Z },
  { 0.3090169943749474242, -0.8090169943749474241, -0.5 _Z },
  { -0.809016994374947424, -0.5, 0.3090169943749474242 _Z } _E },

 {{ -0.5, -0.3090169943749474241, -0.809016994374947424 _Z },
  { -0.309016994374947424, -0.809016994374947424, 0.5 _Z },
  { -0.809016994374947424, 0.5, 0.3090169943749474241 _Z } _E },

 {{ -0.8090169943749474241, -0.5, -0.3090169943749474242 _Z },
  { -0.5, 0.3090169943749474241, 0.8090169943749474241 _Z },
  { -0.3090169943749474241, 0.8090169943749474242, -0.5 _Z } _E },

 {{ -0.8090169943749474248, -0.5, 0.3090169943749474242 _Z },
  { -0.5, 0.3090169943749474242, -0.8090169943749474244 _Z },
  { 0.3090169943749474242, -0.809016994374947424, -0.5 _Z } _E },

 {{ -1.0, 0.0, 0.0 _Z },
  { 0.0, 1.0, 0.0 _Z },
  { 0.0, 0.0, -1.0 _Z } _E }
};


////////////////////////////////////////////////////////////


static void print_matrix(matrix *m)
{
  int i,j;

  for (i = 0; i < _ROWS; i++){
    for (j = 0; j < _COLS; j++)
      printf("%23.19lf ", (*m)[i][j]);
    putchar('\n');
  }
  putchar('\n');
}

matrix4_t* get_rotation_matricies(int *n)
{
  *n = 59;
  return (matrix4_t*) Rotations;
}

void print_rotation_matricies()
{
  int k;

  for(k = 0; k < 59; k++) {
    print_matrix(Rotations+k);
  }
}


////////////////////////////////////////////////////////////
